# 账号池管理仪表盘使用指南

## 概述

账号池管理仪表盘提供了一个可视化界面，用于监控和管理 Suno 账号池的状态。

## 访问地址

- 开发环境: `http://localhost:3000/admin/pool`
- 生产环境: `https://your-domain.com/admin/pool`

## 功能特性

### 1. 统计卡片

仪表盘顶部显示四个关键指标：

- **总账号数**: 账号池中的总账号数量
- **可用账号**: 状态为 `active` 的账号数量（绿色）
- **禁用账号**: 状态为 `disabled` 的账号数量（红色）
- **验证码密钥**: TWOCAPTCHA_KEY 的配置状态

### 2. 维护信息

显示账号池的维护状态：

- **上次维护时间**: 最后一次执行维护的时间戳
- **维护间隔**: 自动维护的时间间隔（默认 15 分钟）
- **距离下次维护**: 实时倒计时，显示距离下次自动维护的剩余时间

### 3. 快速操作

提供两个操作按钮：

- **立即维护**: 手动触发一次全量维护操作
  - 点击后会对所有活跃账号执行保活操作
  - 维护期间按钮显示"维护中..."并禁用
  - 维护完成后自动刷新数据

- **刷新数据**: 手动刷新仪表盘数据
  - 从服务器获取最新的账号池状态
  - 更新所有统计信息和账号列表

### 4. 账号状态概览

以表格形式显示所有账号的详细信息：

| 列名 | 说明 |
|------|------|
| 账号 ID | 账号的唯一标识符（显示前 8 位） |
| 状态 | 账号状态（可用/禁用），使用颜色标识 |
| 支持模型 | 账号支持的音乐生成模型列表 |
| 备注 | 账号的备注信息 |
| 最后更新 | 账号信息的最后更新时间 |

## 自动刷新

仪表盘具有以下自动刷新机制：

- **倒计时更新**: 每秒更新一次距离下次维护的倒计时
- **数据刷新**: 每 30 秒自动从服务器获取最新数据

## 认证要求

访问仪表盘需要管理员认证：

- 用户名: `super`（固定）
- 密码: 管理员密码（存储在数据库中）

如果未认证或认证失败，页面会自动跳转到登录页面。

## 错误处理

仪表盘会显示以下错误信息：

- **获取数据失败**: 无法从服务器获取账号池信息
- **触发维护失败**: 手动维护操作失败
- **认证失败**: 未授权访问，自动跳转到登录页

## 技术实现

### API 端点

仪表盘使用以下 API 端点：

- `GET /api/pool/meta`: 获取账号池元数据和统计信息
- `POST /api/pool/maintenance`: 触发立即维护操作

### 数据结构

```typescript
interface PoolMeta {
  stats: {
    total: number;              // 总账号数
    active: number;             // 可用账号数
    disabled: number;           // 禁用账号数
    lastMaintenance: number | null;  // 上次维护时间戳
    nextMaintenance: number | null;  // 下次维护时间戳
  };
  accounts: Array<{
    id: string;                 // 账号 ID
    cookie: string;             // Cookie（脱敏）
    status: 'active' | 'disabled';  // 状态
    supportedModels: string[];  // 支持的模型
    note: string;               // 备注
    lastUpdated: number;        // 最后更新时间
  }>;
  config: {
    twocaptchaKeyConfigured: boolean;  // 验证码密钥是否配置
    maintenanceIntervalMinutes: number;  // 维护间隔（分钟）
  };
  timestamp: number;            // 数据时间戳
}
```

## 后续任务

当前实现满足需求 11 的所有验收标准。后续任务将实现：

- **任务 13**: 账号列表管理（添加、编辑、删除账号）
- **任务 14**: 日志查看功能
- **任务 15**: 完整的登录和认证功能

## 注意事项

1. 当前登录页面是临时实现，完整的认证功能将在任务 15 中实现
2. 仪表盘使用 localStorage 存储密码（临时方案），生产环境应使用更安全的认证机制
3. 确保数据库已正确初始化，否则页面可能无法正常显示数据
